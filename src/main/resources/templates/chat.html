<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>echo Test</title>
    <script type="text/javascript">
        var ws = null;
        function connect() {
            ws = new WebSocket("ws://" + location.host + "/echo");
            ws.onopen = function () {
                document.getElementById("status").innerText = "创建链接成功, 开始发送消息";
                setInterval(function () {
                    ws.send(document.getElementById("hello").value);
                }, 1000);
            };
            ws.onmessage = function (event) {
                document.getElementById("msg").innerText = event.data;
            };
            ws.onclose = function () {
                document.getElementById("status").innerText = "链接断开, 重连";
                setTimeout(function () {
                    connect();
                }, 1000);
            };
        }
        function disconnect() {
            if (ws != null) {
                ws.close();
                ws = null;
            }
        }
        connect();
    </script>
  </head>
  <body>
    <input type="text" id="hello" value="PING"/>
    <div id="msg"></div>
    <div id="status"></div>
  </body>
</html>